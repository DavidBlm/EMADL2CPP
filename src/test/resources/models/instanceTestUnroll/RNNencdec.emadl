package instanceTestUnroll;

component RNNencdec{
   ports in Z(0:29999)^{75} source,
        out Z(0:29999)^{1} target[91];

   implementation CNN{

     layer LSTM(units=50) encoder;

     source ->
     FullyConnected(units=30000) ->
     Softmax() ->
     ArgMax() ->
     target[0];

     target[0] ->
     Embedding(output_dim=50) ->
     encoder;

     layer LSTM(units=50) decoder;


     encoder.state -> decoder.state;

     timed<t> GreedySearch(max_length=91) {
         target[t-1] ->
         Embedding(output_dim=50) ->
         decoder ->
         FullyConnected(units=30000) ->
         Softmax() ->
         ArgMax() ->
         target[t]
     };

       }
 }
