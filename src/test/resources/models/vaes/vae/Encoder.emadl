package vae;

component Encoder{
    ports in Q(-1000:1000)^{1,28,28} data,
          out Q(-1000:1000)^{8} encoding;

    implementation CNN {
        data ->
        FullyConnected(units=400) ->
        Relu() ->
        Dropout() ->
        FullyConnected(units=200) ->
        Relu() ->
        Dropout() ->
        FullyConnected(units=16) ->
        Split(n=2) ->
        (
            [0]
        |
            [1]
        ) ->
        Reparameterize() ->
        encoding;
    }
}